<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login – CloudSia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module" src="/firebase-config.js"></script>
</head>
<body class="bg-black text-white flex items-center justify-center min-h-screen">

  <div class="w-full max-w-md bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-lg">
    <h2 class="text-2xl font-semibold mb-6 text-center">Welcome to CloudSia</h2>

    <!-- Email/Password Form -->
    <form id="authForm" class="space-y-4">
      <input id="email" type="email" placeholder="Email" required
             class="w-full px-4 py-2 rounded-md bg-white/10 border border-white/20 placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" />

      <input id="password" type="password" placeholder="Password" required
             class="w-full px-4 py-2 rounded-md bg-white/10 border border-white/20 placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" />

      <button id="loginBtn" type="submit"
              class="w-full py-2 rounded-md bg-cyan-500 hover:bg-cyan-400 text-black font-semibold transition">
        Sign In
      </button>
      <p class="text-sm text-gray-400 text-center">
        Don’t have an account? 
        <button id="toggleSignup" type="button" class="text-cyan-400 hover:underline">Sign up</button>
      </p>
    </form>

    <!-- Divider -->
    <div class="flex items-center my-6">
      <div class="flex-1 h-px bg-white/10"></div>
      <span class="px-3 text-gray-400 text-sm">or continue with</span>
      <div class="flex-1 h-px bg-white/10"></div>
    </div>

    <!-- OAuth Buttons -->
    <div class="flex flex-col gap-3">
      <button id="googleSignIn" class="flex items-center justify-center gap-3 bg-white text-black py-2 rounded-md hover:bg-gray-200 transition">
        <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" class="w-5 h-5">
        Sign in with Google
      </button>

      <button id="githubSignIn" class="flex items-center justify-center gap-3 bg-gray-800 text-white py-2 rounded-md hover:bg-gray-700 transition">
        <img src="https://www.svgrepo.com/show/512317/github-142.svg" alt="GitHub" class="w-5 h-5">
        Sign in with GitHub
      </button>
    </div>
  </div>

  <script type="module">
    import { auth, googleProvider, githubProvider } from './firebase-config.js';
    import { signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword } 
      from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    const form = document.getElementById('authForm');
    const toggleSignup = document.getElementById('toggleSignup');
    const loginBtn = document.getElementById('loginBtn');
    let isSignup = false;

    toggleSignup.addEventListener('click', () => {
      isSignup = !isSignup;
      loginBtn.textContent = isSignup ? 'Sign Up' : 'Sign In';
      toggleSignup.textContent = isSignup ? 'Sign in' : 'Sign up';
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      try {
        if (isSignup) {
          await createUserWithEmailAndPassword(auth, email, password);
        } else {
          await signInWithEmailAndPassword(auth, email, password);
        }
        window.location.href = '/'; // redirect home
      } catch (error) {
        alert(error.message);
      }
    });

    document.getElementById('googleSignIn').addEventListener('click', async () => {
      try {
        await signInWithPopup(auth, googleProvider);
        window.location.href = '/';
      } catch (error) {
        alert(error.message);
      }
    });

    document.getElementById('githubSignIn').addEventListener('click', async () => {
      try {
        await signInWithPopup(auth, githubProvider);
        window.location.href = '/';
      } catch (error) {
        alert(error.message);
      }
    });
  </script>
</body>
</html>
